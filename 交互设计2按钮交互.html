<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>äº¤äº’è®¾è®¡2æŒ‰é’®äº¤äº’</title>
</head>
<style>
	html{
		margin: 0;
		padding: 0;
		width: 100%;
		height: 100%;
	}
	body{
		margin: 0;
		padding: 0;
		width: 100%;
		height: 100%;
		background-color: #333;

		transition: transform 1s ease;

	}
	span{
		-moz-user-select: none; /*ç«ç‹*/
		-webkit-user-select: none; /*webkitæµè§ˆå™¨*/
		-ms-user-select: none; /*IE10*/
		user-select: none;
	}
	.main-box{
		position: relative;
		top: 60px;
		height: 800px;
		width: 1200px;
		margin: auto;
		border-radius: 5px; 
		overflow: hidden;
		box-shadow: 2px 2px px 0 rgb(0,0,0);	
	}
	.video-box{
		position: absolute;
		top: 0;
		height: 740px;
		width: 100%;
		background-color: #111;
	}
	.danmu-box{
		position: absolute;
		top: 0;
		height: 740px;
		width: 100%;
		background-color: transparent;
	}
	.danmu{
		position: absolute;
		left: 0;
		width: 20px;
		color: #fff;
		font-size: 22px;
		/*background-color: orange;*/
		transform: translateY(-100%);
		transition: all 5s linear;
	}
	.danmu span{
		word-break:break-all;
	}
	.danmu-insert-box{
		position: absolute;
		bottom: 0;
		width: 100%;
		height: 60px;
		background-color: #555;
		display: flex;
	}
	.danmu-insert{
		height: 40px;
		width: 150px;
		border-radius: 20px;
		margin: 10px 0 10px 60px;
		background-color: #ddd;
		overflow: hidden;
		padding-left: 8px;
		transition: all 0.3s ease;
	}
	.danmu-insert:hover{
		background-color: #fff !important;
		border-radius: 3px !important;
	}
	.danmu-insert input{
		border: 0;
		outline: none;
		display: block;
		width: 100%;
		height: 100%;
		background-color: transparent; 
		font-size: 20px;
	}
	.send-button{
		height: 40px;
		width: 80px;
		margin: 10px;
		border-radius: 20px;
		background-color: #bfe9eb;
		text-align: center;
		line-height: 40px;
		letter-spacing: 2px;
		cursor: pointer;
		transition: all 0.3s ease;
		overflow: hidden;
	}
	.send-button:hover{
		border-radius: 3px !important;
	}

</style>
<body id="body">
	<div class="main-box">
		<div class="video-box">
			<div class="video"></div>
		</div>	
		<div class="danmu-box" id="danmuBox">
			
		</div>
		<div class="danmu-insert-box">
			<div class="danmu-insert" id="danmuText">
				<input type="text" id="input" placeholder="æ¥ç•…å¿«åœ°èŠå¤©å§">
				<!-- <input type="text" id="input"> -->
			</div>
			<div  id="sendBtn" class="send-button" onmousedown="getDanmu()">
				<span>å‘é€</span>
			</div>
		</div>
	</div>
<script type="text/javascript">

	//è·å–è£…å¼¹å¹•çš„ç›’å­ç”¨äºå‘é‡Œé¢æ·»åŠ å¼¹å¹•
	let danmuBox = document.getElementById('danmuBox')
	//è·å–è¾“å…¥æ¡†ï¼Œç”¨äºæ‹¿åˆ°è¾“å…¥çš„ä¿¡æ¯
	let input = document.getElementById("input")
	//è·å–æ•´ä¸ªé¡µé¢ç”¨äºç¿»è½¬
	let body = document.getElementById("body")
	//è¾“å…¥æ¡†ç›’å­ç”¨äºæ§åˆ¶è¾“å…¥æ¡†çš„å¤§å°
	let inputBox = document.getElementById("danmuText")
	//å‘é€æŒ‰é’®
	let sendBtn = document.getElementById("sendBtn")


	//å›è½¦é”®è‡ªåŠ¨å‘é€
	input.onkeydown = function(e){
		if(e.keyCode === 13){//å¦‚æœæŒ‰å›è½¦é”®è°ƒç”¨è·å–å†…å®¹çš„å‡½æ•°
			getDanmu()
		}
	}
	//è¾“å…¥æ¡†èšç„¦å’Œå¤±ç„¦çš„æ ·å¼æ”¹å˜
	input.onfocus = function(){
		inputBox.style.width = "600px"
		inputBox.style.borderRadius = "3px"
		inputBox.style.backgroundColor = "#fff"
	}
	input.onblur = function(){
		if(input.value === ""){
			inputBox.style.width = "150px"
			inputBox.style.borderRadius = "20px"
			inputBox.style.backgroundColor = "#ddd"
		}
	}


	//è·å–å¼¹å¹•
	function getDanmu(){
		let text = input.value	//ä»è¾“å…¥æ¡†ä¸­è·å–è¾“å…¥çš„å†…å®¹
		if(text === ''){	//å¦‚æœæ²¡æœ‰è¾“å…¥(ä¸ºç©ºå­—ç¬¦)
			// alert("è¯·è¾“å…¥å†…å®¹")
		// 	sendBtn.style.backgroundColor = "#ec7a61"
		// 	sendBtn.style.width = "160px"
		// 	sendBtn.innerText = "ä½ è¯´ä½ ğŸå‘¢"
		// 	setTimeout(()=>{
		// 		sendBtn.style.width = "80px"
		// 		sendBtn.style.backgroundColor = "#bfe9eb"
		// 		sendBtn.innerText = "å‘é€"
		// 	},1600)
		// } else if(text === '666'){
		// 	body.style.transform = "rotateZ(180deg)"
		// 	sendDanmu(text)	
		// 	input.value = ''
		} else {

			sendDanmu(text)	//è°ƒç”¨å‘é€å¼¹å¹•å‡½æ•°
			input.value = ''//å°†è¾“å…¥æ¡†æ¸…ç©ºï¼Œä»¥ä¾¿ä¸‹æ¬¡å‘é€

			/** ç‚¹å‡»æ—¶æ— æ³•ä¸»åŠ¨è§¦å‘bluräº‹ä»¶*/
			input.blur() //ä¸»åŠ¨å¤±å»ç„¦ç‚¹ï¼Œæ¢å¤çŸ­çŸ©å½¢çŠ¶æ€

			// sendBtn.style.backgroundColor = "#76fea6"
			// sendBtn.style.width = "160px"
			// sendBtn.innerText = "è¯´çš„è¿˜çœŸä¸é”™"
			// setTimeout(()=>{
			// 	sendBtn.style.width = "80px"
			// 	sendBtn.style.backgroundColor = "#bfe9eb"
			// 	sendBtn.innerText = "å‘é€"
			// },1600)
		}


	}

	//å‘é€å¼¹å¹•
	function sendDanmu(text){

		let i = Math.floor(Math.random()*60)//ç”¨æ¥æ§åˆ¶å¼¹å¹•ä½ç½®çš„éšæœºå‡½æ•°

		let danmu = document.createElement('div')//åˆ›å»ºä¸€ä¸ªå¼¹å¹•å…ƒç´ 
		danmu.setAttribute("class","danmu")//è®¾ç½®å…ƒç´ çš„æ ·å¼
		danmu.style.top = '0px'//å…ƒç´ ä»é¡¶éƒ¨ç”Ÿæˆ
		danmu.style.left =  i*20 +'px'//å…ƒç´ è·ç¦»å·¦è¾¹çš„è·ç¦»(æ ¹æ®éšæœºæ•°è°ƒæ•´)
		danmu.innerHTML = "<span>" + text + "</span>"//å°†è¾“å…¥çš„ä¿¡æ¯æ·»åŠ åˆ°å…ƒç´ ä¸­å»
		danmuBox.appendChild(danmu)//å°†å…ƒç´ æ”¾åˆ°é¡µé¢ä¸Š
	
		moveDanmu(danmu)//è®©å…ƒç´ å¼€å§‹ä¸‹è½

		removeDanmu()//åˆ é™¤å…ƒç´ 
	}

	//è®©å¼¹å¹•ç§»åŠ¨
	function moveDanmu(el){
		setTimeout(()=>{
			el.style.top = "740px"
			el.style.transform = "translateY(100%)"
		},0)
	}

	//å¼¹å¹•åˆ°åº•åç§»é™¤å¼¹å¹•
	function removeDanmu(){
		setTimeout(()=>{
			danmuBox.removeChild(danmuBox.childNodes[1])	
		},5000)
	}
</script>
</body>
</html>